// Generated by CoffeeScript 1.3.1
(function() {
  var changeToNextState, generator, listener, state, states;

  state = 'off';

  states = 'capture.actions capture.matchers generate off'.split(' ');

  changeToNextState = function(tab) {
    state = states[_.indexOf(states, state) + 1] || Â _.first(states);
    chrome.tabs.sendRequest(tab.id, {
      state: state,
      tabURL: tab.url
    }, function() {});
    return chrome.browserAction.setIcon({
      path: "images/button_" + (state.replace('.', '_')) + ".png",
      tabId: tab.id
    });
  };

  chrome.browserAction.onClicked.addListener(changeToNextState);

  generator = new Capybara.SpecGenerator;

  /*
  generateAndCopy: (generator) ->
    specs = generator.generate()
    $('#clipboard').val(specs).focus().select()
    document.execCommand('copy')
    specs
  */


  listener = function(request, sender, sendResponse) {
    switch (request.name) {
      case 'captured':
        return console.log("captured!", request.data);
    }
  };

  chrome.extension.onRequest.addListener(listener);

}).call(this);
